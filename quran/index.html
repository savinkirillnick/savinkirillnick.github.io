<!DOCTYPE html>
<html lang="ru">
<head>
    <!-- –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–≤–∏–∫–æ–Ω -->
    <link rel="icon" href="https://savinkirillnick.github.io/quran/favicon.png">

    <!-- Icons for different sizes on iOS devices -->
    <link rel="apple-touch-icon" sizes="57x57" href="https://savinkirillnick.github.io/quran/icons/icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="https://savinkirillnick.github.io/quran/icons/icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="https://savinkirillnick.github.io/quran/icons/icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="https://savinkirillnick.github.io/quran/icons/icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="https://savinkirillnick.github.io/quran/icons/icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="https://savinkirillnick.github.io/quran/icons/icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="https://savinkirillnick.github.io/quran/icons/icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="https://savinkirillnick.github.io/quran/icons/icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="https://savinkirillnick.github.io/quran/icons/icon-180x180.png">

    <!-- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –¥–ª—è iOS –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π -->
    <meta name="apple-mobile-web-app-capable" content="yes"> <!-- –í–∫–ª—é—á–∞–µ—Ç –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ -->
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"> <!-- –°—Ç–∞—Ç—É—Å–±–∞—Ä –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π —á–µ—Ä–Ω—ã–π -->
    <meta name="theme-color" content="#ffffff"> <!-- –¶–≤–µ—Ç —Ñ–æ–Ω–∞ –æ–∫–Ω–∞ –±—Ä–∞—É–∑–µ—Ä–∞ -->

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta name="description" content="–ö–æ—Ä–∞–Ω –Ω–∞ —Ä—É—Å—Å–∫–æ–º.">
    <meta name="keywords" content="–∫–æ—Ä–∞–Ω, javascript">
    <meta name="author" content="Kirill Savin">
    <meta property="og:title" content="–ö–æ—Ä–∞–Ω" />
    <meta property="og:description" content="–ö–æ—Ä–∞–Ω –Ω–∞ —Ä—É—Å—Å–∫–æ–º." />
    <meta property="og:image" content="https://savinkirillnick.github.io/quran/logo.png" />
    <meta property="og:url" content="https://savinkirillnick.github.io/quran/" />
    <meta property="og:type" content="website" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="–ö–æ—Ä–∞–Ω" />
    <meta name="twitter:description" content="–ö–æ—Ä–∞–Ω –Ω–∞ —Ä—É—Å—Å–∫–æ–º." />
    <meta name="twitter:image" content="https://savinkirillnick.github.io/quran/logo.png" />
    <title>–ö–æ—Ä–∞–Ω</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #fafafa;
            color: #333;
            text-align: center;
            font-size: 12pt;
        }
        p {
            text-indent: 30px;
            line-height: 1.4;
        }
        .screen {
            position: relative;
            max-width: 600px;
            left: 50%;
            transform: translate(-50%, 0%);
        }
        .num {
            font-weight: bold;
        }
        .content {
            max-width: 600px;
            margin: 20px auto;
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 5px;
            background-color: white;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            text-align: left;
        }
        .controls button {
            margin: 5px;
            padding: min(20px, 3vw);
            background: transparent;
            border: 0;
            font-size: min(20pt, 5vw);
            cursor: pointer;
            transition: all 0.3s ease-in-out;
        }
        .menu {
            display: none;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }
        .chapters {
            display: none;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
            min-height: 50px;
            position: absolute;
            top: calc(6vw + 10px + min(20pt, 5vw));
            left: 50%;
            transform: translate(-50%, 0%);
            white-space: nowrap;
        }
        .menu-item {
            text-align: left;
            padding: 5px;
            margin: 0;
        }
        .chapters-item {
            text-align: center;
            padding: 5px;
            margin: 0;
        }
        .link {
            color: #06d;
            cursor: pointer;
        }
        .gray {
            color: #666;
        }
    </style>
    <script src="main.js"></script>
    <script src="ayatofday.js"></script>
</head>
<body>

<div class="screen">
    <div class="controls top-controls">
        <button onclick="previousChapter()">‚óÄÔ∏è</button>
        <button onclick="showMainPage()">üè†</button>
        <button onclick="showSurahMenu()">üìï</button>
        <button onclick="showChapterMenu()">üìÉ</button>
        <!-- <button onclick="showTranslateMenu()">‚öôÔ∏è</button> -->
        <button onclick="nextChapter()">‚ñ∂Ô∏è</button>
    </div>
    <div class="content" id="content"></div>
    <div class="content" id="last-surah"></div>
    <div class="content" id="ayat-of-day"></div>
    <div class="content menu" id="surahs-menu"></div>
    <div class="content chapters" id="chapters-menu"></div>
    <div class="controls bottom-controls">
        <button onclick="previousChapter(); window.scrollTo(0, 0);">‚óÄÔ∏è</button>
        <button onclick="window.scrollTo(0, 0);">‚¨ÜÔ∏è</button>
        <button onclick="nextChapter(); window.scrollTo(0, 0);">‚ñ∂Ô∏è</button>
    </div>
    <div class="content">
    <center>–ö–æ—Ä–∞–Ω 2025<br>–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è, –Ω–∞–ø–∏—à–∏—Ç–µ –º–Ω–µ –≤ —Ç–µ–ª–µ–≥—Ä–∞–º <a class="link" href="https://t.me/savinkirillnick">@savinkirillnick</a></center>
    </div>
</div>
<script type="text/javascript">

//–°–ø–∏—Å–æ–∫ –∫–Ω–∏–≥
const lib = new Lib();

function showMainPage() {
  document.getElementById('content').style.display = "none";
  document.getElementById('surahs-menu').style.display = "none";
  document.getElementById('chapters-menu').style.display = "none";
  document.getElementById('last-surah').style.display = "block";
  document.getElementById('ayat-of-day').style.display = "block";
}

function showSurahMenu() {
  document.getElementById('last-surah').style.display = "none";
  document.getElementById('ayat-of-day').style.display = "none";
  document.getElementById('chapters-menu').style.display = "none";
  if (document.getElementById('content').style.display === "none") {
    document.getElementById('content').style.display = "block";
    document.getElementById('surahs-menu').style.display = "none";
  } else {
    document.getElementById('content').style.display = "none";
    document.getElementById('surahs-menu').style.display = "grid";
  }
}

// –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –º–µ–Ω—é
function generateSurahsMenu(lib) {
  let html = '';
  
  lib.surah.forEach(surah => {
        html += `<div class="menu-item link" onclick="changeSurah('${surah.link}'); window.scrollTo(0, 0);">${surah.title}</div>`;
      });
  
  return html;
}

document.getElementById('surahs-menu').innerHTML = generateSurahsMenu(lib.lib);

async function showChapterMenu() {
  document.getElementById('last-surah').style.display = "none";
  document.getElementById('ayat-of-day').style.display = "none";
  try {
    document.getElementById('content').style.display = "block";
    document.getElementById('surahs-menu').style.display = "none";
    if (document.getElementById('chapters-menu').style.display === "none") {
        document.getElementById('chapters-menu').style.display = "grid";
    } else {
        document.getElementById('chapters-menu').style.display = "none";
    }
    const chapters = await quran.getChaptersList();
    document.getElementById('chapters-menu').innerHTML = generateChaptersMenu(chapters);

  } catch (error) {
    console.error('–û—à–∏–±–∫–∞:', error);
  }
}

function generateChaptersMenu(chapters) {
  let html = '';
  chapters.forEach(item => {
    html += `<div class="chapters-item link" onclick="changeChapter('${item.index}'); window.scrollTo(0, 0);">${item.number}</div>`;
  });
  return html;
}

function formatDateToNormal(dateStr) {
  const options = { year: 'numeric', month: 'long', day: 'numeric' };
  const date = new Date(dateStr);
  return date.toLocaleDateString('ru-RU', options);
}
    
function showLastSurah(info) {
  // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω—é—é –∫–Ω–∏–≥—É –Ω–∞ –≥–ª–∞–≤–Ω–æ–π
  const last_surah = quran.lastSeen();
  let text = "<h3>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</h3>";
  if (last_surah.surah === 'byt' && last_surah.chapterIndex === 0) {
    text += `<p>–ù–∞—á–Ω–∏—Ç–µ —á—Ç–µ–Ω–∏–µ –°–≤—è—â–µ–Ω–æ–≥–æ –ü–∏–∞–Ω–∏—è —Å —Å—É—Ä—ã ¬´–û—Ç–∫—Ä—ã–≤–∞—é—â–∞—è –ö–æ—Ä–∞–Ω¬ª.</p>`;
    text += `<span class="link" onclick="changeSurah('${last_surah.surah}'); changeChapter('${last_surah.chapterIndex}'); window.scrollTo(0, 0);">–ù–∞—á–∞—Ç—å —á–∏—Ç–∞—Ç—å</span>`;
  } else {

    let chapterNumber = info.chapterNumber;
    chapterNumber = `${chapterNumber}`;
    text += `<p>–ü–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞–∑ –≤—ã —á–∏—Ç–∞–ª–∏ ¬´${lib.short[last_surah.surah].full}¬ª, ${chapterNumber}.</p>`;
    text += `<span class="link" onclick="changeSurah('${last_surah.surah}'); changeChapter('${last_surah.chapterIndex}'); window.scrollTo(0, 0);">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</span>`;
  }
  return text;
}

function showAyatOfTheDay() {
  // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–∏—Ö –¥–Ω—è
  let text = "<h3>–°—Ç–∏—Ö –¥–Ω—è</h3>";
    
  // –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–µ–≥–æ–¥–Ω—è—à–Ω–µ–≥–æ —á–∏—Å–ª–∞ –≥–æ–¥–∞
  const today = new Date();
  const dayOfYear = Math.floor((today - new Date(today.getFullYear(), 0, 0)) / 1000 / 60 / 60 / 24);
    
  // –ò–Ω–¥–µ–∫—Å –≤—ã–±–∏—Ä–∞–µ–º–æ–≥–æ —Å—Ç–∏—Ö–∞
  const index = dayOfYear % ayatofday.length;

  text += `<p>${ayatofday[index].ayat}</p>`;
  text += `<p><span class="gray">${ayatofday[index].code}</span></p>`;
  
  return text;
}

// –°–æ–∑–¥–∞–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä –∫–Ω–∏–≥–∏
const quran = new Surah();

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å async/await
async function loadChapter() {
  try {
    const text = await quran.showText();
    document.getElementById('content').innerHTML = text;
    
    // –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–Ω–∏–≥–µ
    const info = quran.getSurahInfo();
    document.getElementById('last-surah').innerHTML = showLastSurah(info);
    console.log('–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–Ω–∏–≥–µ:', info);
    
    // –ü–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ –≥–ª–∞–≤
    const chapters = await quran.getChaptersList();
    document.getElementById('chapters-menu').innerHTML = generateChaptersMenu(chapters);
    console.log('–î–æ—Å—Ç—É–ø–Ω—ã–µ –≥–ª–∞–≤—ã:', chapters);

    document.getElementById('ayat-of-day').innerHTML = showAyatOfTheDay();
    
  } catch (error) {
    console.error('–û—à–∏–±–∫–∞:', error);
  }
}

// –°–º–µ–Ω–∞ –ø–µ—Ä–µ–≤–æ–¥–∞
async function changeTranslation(newTranslation) {
  const text = await quran.showText(newTranslation, quran.surah, quran.chapter);
  document.getElementById('content').innerHTML = text;
}

// –°–º–µ–Ω–∞ –∫–Ω–∏–≥–∏
async function changeSurah(newSurah) {
  document.getElementById('last-surah').style.display = "none";
  document.getElementById('ayat-of-day').style.display = "none";
  document.getElementById('content').style.display = "block";
  document.getElementById('surahs-menu').style.display = "none";
  const text = await quran.showText(quran.translate, newSurah, 0);
  document.getElementById('content').innerHTML = text;
}

// –°–º–µ–Ω–∞ –≥–ª–∞–≤—ã
async function changeChapter(newChapter) {
  document.getElementById('last-surah').style.display = "none";
  document.getElementById('ayat-of-day').style.display = "none";
  document.getElementById('chapters-menu').style.display = "none";
  const text = await quran.showText(quran.translate, quran.surah, newChapter);
  document.getElementById('content').innerHTML = text;
}

// –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –≥–ª–∞–≤–∞–º
async function nextChapter() {
  const text = await quran.nextChapter();
  if (text) {
    document.getElementById('content').innerHTML = text;
  }
}

async function previousChapter() {
  const text = await quran.previousChapter();
  if (text) {
    document.getElementById('content').innerHTML = text;
  }
}

function mark(surah, chapter, ayat, item) {
  quran.mark(surah, chapter, ayat, item);
}

loadChapter();
showMainPage();    
</script>
</body>
</html>
